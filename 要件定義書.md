# TimeDonut - 要件定義書

## プロジェクト概要

### プロジェクト名
TimeDonut（タイムドーナツ）

### 目的
Googleカレンダーの予定を視覚的に確認できるmacOS常駐型メニューバーアプリケーションを開発する。
ユーザーが次の予定までの時間を一目で把握でき、アナログ時計とドーナツグラフで直感的に予定を可視化できるようにする。

### 開発背景
- カレンダーアプリを都度開くのが面倒
- 次の予定までの時間を常に把握したい
- 視覚的に一日の予定を俯瞰したい

---

## ステークホルダー

### 対象ユーザー
- macOSユーザー
- Googleカレンダーを使用している個人・ビジネスユーザー
- 時間管理を重視するユーザー

---

## 機能要件

### 必須機能（MVP）

#### 1. Google認証
- **FR-001**: Googleアカウントでのサインイン機能
- **FR-002**: OAuth 2.0による安全な認証
- **FR-003**: 認証状態の永続化（Keychain利用）
- **FR-004**: サインアウト機能

#### 2. メニューバー表示
- **FR-005**: メニューバーに次の予定までの残り時間を表示
  - 表示形式: `⏰ XX分後` または `⏰ X時間XX分後`
  - 予定がない場合: `⏰ 予定なし`
- **FR-006**: メニューバーアイテムはクリック可能

#### 3. Googleカレンダー連携
- **FR-007**: Googleカレンダーから今日・明日の予定を取得
- **FR-008**: 定期的なカレンダーデータ同期（5分間隔）
- **FR-009**: 次の予定の自動検出・計算
- **FR-010**: 複数カレンダーの統合表示

#### 4. ポップオーバー表示
- **FR-011**: メニューバーアイテムクリックでポップオーバー表示
- **FR-012**: アナログ時計の表示（12時間表示）
- **FR-013**: 予定をドーナツグラフとして時計外周に表示
  - 各予定を時間帯に応じた位置・長さで表示
  - 予定ごとに色分け
- **FR-014**: 今日の予定リスト表示
  - 開始時刻
  - 予定タイトル
  - 所要時間

#### 5. 常駐機能
- **FR-015**: macOS起動時の自動起動（オプション）
- **FR-016**: Dockに表示しない
- **FR-017**: メニューバーのみに常駐
- **FR-018**: バックグラウンドでの動作

### 今後検討する機能（将来拡張）

#### Phase 2
- **FR-100**: 予定へのクイックアクセス（Google Meetリンク等）
- **FR-101**: 通知機能（予定開始前のリマインダー）
- **FR-102**: 複数Googleアカウント対応
- **FR-103**: カレンダーの選択的表示（仕事/プライベート等）

#### Phase 3
- **FR-200**: ウィジェット表示モード
- **FR-201**: ダークモード対応
- **FR-202**: カスタムカラーテーマ
- **FR-203**: 予定の作成・編集機能

---

## 非機能要件

### パフォーマンス
- **NFR-001**: メモリ使用量は50MB以下に抑える（常駐アプリのため）
- **NFR-002**: CPU使用率は平常時1%以下
- **NFR-003**: カレンダーデータ取得は5秒以内に完了
- **NFR-004**: UI操作の応答時間は100ms以内

### セキュリティ
- **NFR-005**: 認証トークンはKeychainで暗号化保存
- **NFR-006**: 通信は全てHTTPS
- **NFR-007**: 必要最小限のカレンダー権限のみ要求

### 可用性
- **NFR-008**: ネットワーク切断時も既存データで動作継続
- **NFR-009**: API障害時のエラーハンドリング
- **NFR-010**: クラッシュ時の自動再起動機能

### 互換性
- **NFR-011**: macOS 13 Ventura以降をサポート
- **NFR-012**: Apple Silicon (M1/M2/M3) とIntel両対応

### 保守性
- **NFR-013**: Swift 5.9以降で開発
- **NFR-014**: SwiftUIでUI実装
- **NFR-015**: モジュール分割による保守性確保

---

## 制約条件

### 技術的制約
- **C-001**: macOS専用アプリケーション（Windows/Linux非対応）
- **C-002**: Googleカレンダーのみ対応（他カレンダーサービス非対応）
- **C-003**: インターネット接続必須（初回認証・データ同期時）

### ビジネス制約
- **C-004**: 個人開発プロジェクト（予算制約あり）
- **C-005**: Google Calendar API無料枠内での利用

### スケジュール制約
- **C-006**: MVP完成目標: 2-3週間

---

## 前提条件

### ユーザー環境
- macOS 13 Ventura以降がインストールされている
- Googleアカウントを所持している
- インターネット接続が可能

### 開発環境
- Xcode 15以降
- Swift 5.9以降
- Google Cloud Platformアカウント（API Key取得用）

---

## 成功基準

### 定量的基準
- メモリ使用量: 50MB以下
- バッテリー影響: 1日の消費量1%以下
- クラッシュ率: 0.1%以下

### 定性的基準
- ユーザーがカレンダーアプリを開く頻度が減る
- 予定の見落としが減る
- 時間管理の効率が向上する

---

## リスク管理

| リスク | 影響度 | 発生確率 | 対策 |
|--------|--------|----------|------|
| Google API利用制限 | 高 | 中 | キャッシュ活用、リクエスト頻度制限 |
| 認証トークン期限切れ | 中 | 高 | 自動リフレッシュ機能実装 |
| macOSバージョンアップ互換性 | 中 | 中 | Beta版での事前検証 |
| メモリリーク | 高 | 低 | 定期的なメモリ監視、テスト |

---

## 承認

| 役割 | 氏名 | 承認日 | 署名 |
|------|------|--------|------|
| プロジェクトオーナー | - | 2025-10-26 | - |

---

**文書バージョン**: 1.0
**最終更新日**: 2025-10-26
**作成者**: Claude Code
